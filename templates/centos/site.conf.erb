DBDriver pgsql
DBDParams "dbname=<%= node['application']['db']['name'] %> user=<%= node['application']['db']['name'] %> password=<%= node['application']['db']['password'] %> host=<%= node['application']['db']['host'] %>"

DBDMin 1
DBDKeep 2
DBDMax 4
DBDExptime 60

Alias /<%= node['application']['name'] %> <%= node['application']['dir']['public'] %>

<FilesMatch \.php$>
    SetHandler application/x-httpd-php
</FilesMatch>

DirectoryIndex index.php index.html

<Directory <%= node['application']['dir'] %>>
    AllowOverride All
    EnableMMAP Off
    EnableSendfile Off
</Directory>
<Location /<%= node['application']['name'] %>>
<% if node['application']['auth']['require'] %>
    AuthType Basic
    AuthName "<%= node['application']['auth']['name'] %>"
    AuthBasicProvider dbd

    AuthDBDUserPWQuery "SELECT <%= node['application']['auth']['db']['password_field'] %> FROM <%= node['application']['auth']['db']['table'] %> WHERE <%= node['application']['auth']['db']['id_field'] %> = %s"

    Require valid-user
<% elsif %>
    Require all granted
<% end %>
</Location>